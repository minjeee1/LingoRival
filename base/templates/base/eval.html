{% extends 'main.html' %}

{% block content %}

<div id="room-data" data-room-id="{{ gameroom.id }}">
    
    <div>
        {% for participant in gameroom.participants.all %}
            {% if participant == request.user %}
                <span><strong>@{{ participant }}</strong></span>
            {% endif %}
        {% endfor %}
        {% for participant in gameroom.participants.all %}
            {% if participant != request.user %}
                <span>@{{ participant }}</span>
            {% endif %}
        {% endfor %}
    
    </div>
    <small>{{gameroom.native_language}} -> {{gameroom.target_language}}</small>



    <div class="room-container">

        <h1>{{gameroom}}</h1>
        <p>ë¬¸ì œ: {{ Quiz }}</p>

        <hr>
        <h2>Translate Recommendation</h2>
        <p>ë‹µë³€: {{ Answer }}</p>
        <h2>ë‚´ ë‹µë³€</h2>
        {% if user_answer.body|length > 5 %}
          <p>{{ user_answer.body }}</p>
          <h3>ğŸ¤–AI's Opinion</h3>
          <p>{{ user_response }}</p>
        {% else %}
          <p>{{ user_answer.body }} <br> => ë¹„ì •ìƒì ì¸ ë‹µë³€ì…ë‹ˆë‹¤.</p>
        {% endif %}
        
        

        <h2>ìƒëŒ€ë°©ì˜ ë‹µë³€</h2>
        {% if opponent_answer.body|length > 5 %}
          <p>{{ opponent_answer.body }}</p>
          <h3>ğŸ¤–AI's Opinion</h3>
          <p>{{ opponent_response }}</p>
        {% else %}
          <p>{{ opponent_answer.body }} <br> => ë¹„ì •ìƒì ì¸ ë‹µë³€ì…ë‹ˆë‹¤.</p>
        {% endif %}

        <hr>
        <h2>Winner</h2>
        <ul>
            {% if gameroom.host == request.user %}
                {% for result in evaluation_results %}
                    {% if result == 'h' %}
                        Win
                    {% else %}
                        Lose
                    {% endif %}
                {% endfor %}
            {% else %}
                {% for result in evaluation_results %}
                    {% if result == 'h' %}
                        Lose
                    {% else %}
                        Win
            {% endif %}
        {% endfor %}

            {% endif %}
        </ul>
    </div>

</div>




<!-- í…œí”Œë¦¿ ë‚´ë¶€ì—ì„œ JavaScript í•¨ìˆ˜ í˜¸ì¶œ -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- jQueryë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ jQuery ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤. -->
<script>

    // var currentRoomID = document.getElementById('room-data').getAttribute('data-room-id');

    // ì‚¬ìš©ìê°€ í˜ì´ì§€ë¥¼ ë– ë‚  ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
    window.onbeforeunload = function () {
        return false;}

    function submitForm(form) {
        // ì´ ë¶€ë¶„ì—ì„œ í•„ìš”í•œ ìœ íš¨ì„± ê²€ì‚¬ ë“±ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
        // ë§Œì•½ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í•˜ì§€ ëª»í•˜ë©´ falseë¥¼ ë°˜í™˜í•˜ê³  ì œì¶œì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤.
        // ì˜ˆë¥¼ ë“¤ì–´, ë‹µë³€ì´ ë¹„ì–´ìˆëŠ” ê²½ìš° ì œì¶œì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

        // í¼ì„ ì œì¶œí•©ë‹ˆë‹¤.
        form.submit();
        event.preventDefault();

        // í¼ ì œì¶œ í›„ì—ëŠ” í˜ì´ì§€ ë¦¬ë¡œë“œë¥¼ ë§‰ê¸° ìœ„í•´ falseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
        return false;
    }
    
    document.getElementById('Submit-button').addEventListener('click', function () {
        formSubmitted = true; // ì œì¶œ í”Œë˜ê·¸ ì„¤ì •
        window.onbeforeunload = null; // ê²½ê³  ë©”ì‹œì§€ ë¹„í™œì„±í™”
    });  


</script>

    

{% endblock %}